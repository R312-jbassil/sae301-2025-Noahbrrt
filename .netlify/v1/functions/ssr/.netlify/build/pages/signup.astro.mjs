import { d as createComponent, e as createAstro, j as renderComponent, r as renderTemplate, g as addAttribute, m as maybeRenderHead } from '../chunks/astro/server_CRDH0bDr.mjs';
import { $ as $$Layout } from '../chunks/Layout_D1VYXbu9.mjs';
export { renderers } from '../renderers.mjs';

var __freeze = Object.freeze;
var __defProp = Object.defineProperty;
var __template = (cooked, raw) => __freeze(__defProp(cooked, "raw", { value: __freeze(raw || cooked.slice()) }));
var _a;
const $$Astro = createAstro();
const prerender = false;
const $$Signup = createComponent(async ($$result, $$props, $$slots) => {
  const Astro2 = $$result.createAstro($$Astro, $$props, $$slots);
  Astro2.self = $$Signup;
  if (Astro2.locals.user) {
    return Astro2.redirect("/galerie");
  }
  const redirectTo = Astro2.url.searchParams.get("redirectTo") || "/galerie";
  return renderTemplate`${renderComponent($$result, "Layout", $$Layout, { "title": "Cr\xE9er un compte \u2014 TaVue" }, { "default": async ($$result2) => renderTemplate(_a || (_a = __template([" ", '<section class="min-h-[80vh] flex items-center px-4 py-10"> <div class="mx-auto w-full max-w-lg rounded-2xl border bg-white/95 p-6 sm:p-8 shadow-lg backdrop-blur"> <header class="mb-6 sm:mb-8 text-center"> <h1 class="text-2xl sm:text-3xl font-semibold">Cr\xE9er un compte</h1> <p class="mt-2 text-sm text-gray-600">Rejoignez TaVue en quelques secondes.</p> </header> <form id="signup-form" class="space-y-4 sm:space-y-5" novalidate> <input type="hidden" name="redirectTo"', '> <div class="rounded-xl border bg-gray-50/70 p-3 sm:p-4 transition focus-within:border-black/70"> <label for="name" class="block text-sm font-medium text-gray-800 mb-1.5">Nom (optionnel)</label> <input id="name" name="name" type="text" autocomplete="name" class="w-full h-12 rounded-lg border border-gray-300 bg-white px-3 text-[15px] focus:outline-none focus:ring-2 focus:ring-black/60" placeholder="Ex. Marie Dupont"> <p id="err-name" class="mt-1 text-xs text-red-600"></p> </div> <!-- Email --> <div class="rounded-xl border bg-gray-50/70 p-3 sm:p-4 transition focus-within:border-black/70"> <label for="email" class="block text-sm font-medium text-gray-800 mb-1.5">Email</label> <input id="email" name="email" type="email" required autocomplete="email" class="w-full h-12 rounded-lg border border-gray-300 bg-white px-3 text-[15px] focus:outline-none focus:ring-2 focus:ring-black/60" placeholder="vous@exemple.fr"> <p id="err-email" class="mt-1 text-xs text-red-600"></p> </div> <div class="rounded-xl border bg-gray-50/70 p-3 sm:p-4 transition focus-within:border-black/70"> <div class="flex items-center justify-between"> <label for="password" class="block text-sm font-medium text-gray-800 mb-1.5">Mot de passe</label> <span id="hint-len" class="text-[11px] text-gray-500">6 caract\xE8res minimum</span> </div> <div class="relative"> <input id="password" name="password" type="password" required minlength="6" autocomplete="new-password" class="w-full h-12 rounded-lg border border-gray-300 bg-white pr-12 px-3 text-[15px] focus:outline-none focus:ring-2 focus:ring-black/60" placeholder="Au moins 6 caract\xE8res"> <button type="button" id="toggle-pass" class="absolute inset-y-0 right-2 my-auto px-2 text-sm text-gray-600 hover:text-black">\nAfficher\n</button> </div> <p id="err-password" class="mt-1 text-xs text-red-600"></p> </div> <!-- Confirmation --> <div class="rounded-xl border bg-gray-50/70 p-3 sm:p-4 transition focus-within:border-black/70"> <label for="passwordConfirm" class="block text-sm font-medium text-gray-800 mb-1.5">Confirmer le mot de passe</label> <div class="relative"> <input id="passwordConfirm" name="passwordConfirm" type="password" required minlength="6" autocomplete="new-password" class="w-full h-12 rounded-lg border border-gray-300 bg-white pr-12 px-3 text-[15px] focus:outline-none focus:ring-2 focus:ring-black/60" placeholder="R\xE9p\xE9tez le mot de passe"> <button type="button" id="toggle-pass2" class="absolute inset-y-0 right-2 my-auto px-2 text-sm text-gray-600 hover:text-black">\nAfficher\n</button> </div> <p id="err-passwordConfirm" class="mt-1 text-xs text-red-600"></p> </div> <!-- CTA --> <button id="btn-submit" type="submit" class="btn btn-primary w-full h-12 text-[15px] font-semibold"> <span class="inline-flex items-center gap-2"> <svg id="spinner" class="hidden animate-spin h-4 w-4" viewBox="0 0 24 24"> <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4" fill="none"></circle> <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8v4A4 4 0 008 12H4z"></path> </svg>\nS\u2019inscrire\n</span> </button> <p class="text-center text-sm text-gray-600">\nD\xE9j\xE0 un compte ?\n<a class="link"', '>Se connecter</a> </p> <p id="status" class="text-center text-sm text-red-600 min-h-[1rem]"></p> </form> </div> </section> <script>\n    const form = document.getElementById("signup-form");\n    const statusEl = document.getElementById("status");\n    const btn = document.getElementById("btn-submit");\n    const spinner = document.getElementById("spinner");\n\n    const email = document.getElementById("email");\n    const pass = document.getElementById("password");\n    const pass2 = document.getElementById("passwordConfirm");\n\n    const errEmail = document.getElementById("err-email");\n    const errPass = document.getElementById("err-password");\n    const errPass2 = document.getElementById("err-passwordConfirm");\n\n    document.getElementById("toggle-pass")?.addEventListener("click", () => {\n      const t = pass.type === "password" ? "text" : "password";\n      pass.type = t;\n      document.getElementById("toggle-pass").textContent = t === "password" ? "Afficher" : "Masquer";\n    });\n    document.getElementById("toggle-pass2")?.addEventListener("click", () => {\n      const t = pass2.type === "password" ? "text" : "password";\n      pass2.type = t;\n      document.getElementById("toggle-pass2").textContent = t === "password" ? "Afficher" : "Masquer";\n    });\n\n    function validate() {\n      let ok = true;\n      errEmail.textContent = "";\n      errPass.textContent = "";\n      errPass2.textContent = "";\n\n      if (!email.value.trim() || !/^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/.test(email.value)) {\n        errEmail.textContent = "Entrez un email valide.";\n        ok = false;\n      }\n      if (!pass.value || pass.value.length < 6) {\n        errPass.textContent = "Au moins 6 caract\xE8res.";\n        ok = false;\n      }\n      if (pass2.value !== pass.value) {\n        errPass2.textContent = "Les mots de passe ne correspondent pas.";\n        ok = false;\n      }\n      return ok;\n    }\n\n    pass2.addEventListener("input", () => {\n      if (pass2.value && pass.value && pass2.value !== pass.value) {\n        errPass2.textContent = "Les mots de passe ne correspondent pas.";\n      } else {\n        errPass2.textContent = "";\n      }\n    });\n\n    form?.addEventListener("submit", async (e) => {\n      e.preventDefault();\n      statusEl.textContent = "";\n\n      if (!validate()) {\n        const firstErr = document.querySelector(".text-red-600:not(:empty)");\n        firstErr?.scrollIntoView({ behavior: "smooth", block: "center" });\n        return;\n      }\n\n      btn.disabled = true;\n      spinner.classList.remove("hidden");\n\n      const fd = new FormData(form);\n      const payload = {\n        name: (fd.get("name") || "").toString(),\n        email: (fd.get("email") || "").toString(),\n        password: (fd.get("password") || "").toString(),\n        passwordConfirm: (fd.get("passwordConfirm") || "").toString(),\n      };\n\n      try {\n        const res = await fetch("/api/signup", {\n          method: "POST",\n          headers: { "Content-Type": "application/json" },\n          credentials: "include",\n          body: JSON.stringify(payload),\n        });\n\n        if (res.ok) {\n          const redirectTo = (fd.get("redirectTo") || "/galerie").toString();\n          window.location.href = redirectTo;\n        } else {\n          const r = await res.json().catch(() => ({}));\n          statusEl.textContent = r?.error || "Erreur d\u2019inscription.";\n        }\n      } catch {\n        statusEl.textContent = "Impossible de contacter le serveur.";\n      } finally {\n        btn.disabled = false;\n        spinner.classList.add("hidden");\n      }\n    });\n  <\/script> '], [" ", '<section class="min-h-[80vh] flex items-center px-4 py-10"> <div class="mx-auto w-full max-w-lg rounded-2xl border bg-white/95 p-6 sm:p-8 shadow-lg backdrop-blur"> <header class="mb-6 sm:mb-8 text-center"> <h1 class="text-2xl sm:text-3xl font-semibold">Cr\xE9er un compte</h1> <p class="mt-2 text-sm text-gray-600">Rejoignez TaVue en quelques secondes.</p> </header> <form id="signup-form" class="space-y-4 sm:space-y-5" novalidate> <input type="hidden" name="redirectTo"', '> <div class="rounded-xl border bg-gray-50/70 p-3 sm:p-4 transition focus-within:border-black/70"> <label for="name" class="block text-sm font-medium text-gray-800 mb-1.5">Nom (optionnel)</label> <input id="name" name="name" type="text" autocomplete="name" class="w-full h-12 rounded-lg border border-gray-300 bg-white px-3 text-[15px] focus:outline-none focus:ring-2 focus:ring-black/60" placeholder="Ex. Marie Dupont"> <p id="err-name" class="mt-1 text-xs text-red-600"></p> </div> <!-- Email --> <div class="rounded-xl border bg-gray-50/70 p-3 sm:p-4 transition focus-within:border-black/70"> <label for="email" class="block text-sm font-medium text-gray-800 mb-1.5">Email</label> <input id="email" name="email" type="email" required autocomplete="email" class="w-full h-12 rounded-lg border border-gray-300 bg-white px-3 text-[15px] focus:outline-none focus:ring-2 focus:ring-black/60" placeholder="vous@exemple.fr"> <p id="err-email" class="mt-1 text-xs text-red-600"></p> </div> <div class="rounded-xl border bg-gray-50/70 p-3 sm:p-4 transition focus-within:border-black/70"> <div class="flex items-center justify-between"> <label for="password" class="block text-sm font-medium text-gray-800 mb-1.5">Mot de passe</label> <span id="hint-len" class="text-[11px] text-gray-500">6 caract\xE8res minimum</span> </div> <div class="relative"> <input id="password" name="password" type="password" required minlength="6" autocomplete="new-password" class="w-full h-12 rounded-lg border border-gray-300 bg-white pr-12 px-3 text-[15px] focus:outline-none focus:ring-2 focus:ring-black/60" placeholder="Au moins 6 caract\xE8res"> <button type="button" id="toggle-pass" class="absolute inset-y-0 right-2 my-auto px-2 text-sm text-gray-600 hover:text-black">\nAfficher\n</button> </div> <p id="err-password" class="mt-1 text-xs text-red-600"></p> </div> <!-- Confirmation --> <div class="rounded-xl border bg-gray-50/70 p-3 sm:p-4 transition focus-within:border-black/70"> <label for="passwordConfirm" class="block text-sm font-medium text-gray-800 mb-1.5">Confirmer le mot de passe</label> <div class="relative"> <input id="passwordConfirm" name="passwordConfirm" type="password" required minlength="6" autocomplete="new-password" class="w-full h-12 rounded-lg border border-gray-300 bg-white pr-12 px-3 text-[15px] focus:outline-none focus:ring-2 focus:ring-black/60" placeholder="R\xE9p\xE9tez le mot de passe"> <button type="button" id="toggle-pass2" class="absolute inset-y-0 right-2 my-auto px-2 text-sm text-gray-600 hover:text-black">\nAfficher\n</button> </div> <p id="err-passwordConfirm" class="mt-1 text-xs text-red-600"></p> </div> <!-- CTA --> <button id="btn-submit" type="submit" class="btn btn-primary w-full h-12 text-[15px] font-semibold"> <span class="inline-flex items-center gap-2"> <svg id="spinner" class="hidden animate-spin h-4 w-4" viewBox="0 0 24 24"> <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4" fill="none"></circle> <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8v4A4 4 0 008 12H4z"></path> </svg>\nS\u2019inscrire\n</span> </button> <p class="text-center text-sm text-gray-600">\nD\xE9j\xE0 un compte ?\n<a class="link"', '>Se connecter</a> </p> <p id="status" class="text-center text-sm text-red-600 min-h-[1rem]"></p> </form> </div> </section> <script>\n    const form = document.getElementById("signup-form");\n    const statusEl = document.getElementById("status");\n    const btn = document.getElementById("btn-submit");\n    const spinner = document.getElementById("spinner");\n\n    const email = document.getElementById("email");\n    const pass = document.getElementById("password");\n    const pass2 = document.getElementById("passwordConfirm");\n\n    const errEmail = document.getElementById("err-email");\n    const errPass = document.getElementById("err-password");\n    const errPass2 = document.getElementById("err-passwordConfirm");\n\n    document.getElementById("toggle-pass")?.addEventListener("click", () => {\n      const t = pass.type === "password" ? "text" : "password";\n      pass.type = t;\n      document.getElementById("toggle-pass").textContent = t === "password" ? "Afficher" : "Masquer";\n    });\n    document.getElementById("toggle-pass2")?.addEventListener("click", () => {\n      const t = pass2.type === "password" ? "text" : "password";\n      pass2.type = t;\n      document.getElementById("toggle-pass2").textContent = t === "password" ? "Afficher" : "Masquer";\n    });\n\n    function validate() {\n      let ok = true;\n      errEmail.textContent = "";\n      errPass.textContent = "";\n      errPass2.textContent = "";\n\n      if (!email.value.trim() || !/^[^\\\\s@]+@[^\\\\s@]+\\\\.[^\\\\s@]+$/.test(email.value)) {\n        errEmail.textContent = "Entrez un email valide.";\n        ok = false;\n      }\n      if (!pass.value || pass.value.length < 6) {\n        errPass.textContent = "Au moins 6 caract\xE8res.";\n        ok = false;\n      }\n      if (pass2.value !== pass.value) {\n        errPass2.textContent = "Les mots de passe ne correspondent pas.";\n        ok = false;\n      }\n      return ok;\n    }\n\n    pass2.addEventListener("input", () => {\n      if (pass2.value && pass.value && pass2.value !== pass.value) {\n        errPass2.textContent = "Les mots de passe ne correspondent pas.";\n      } else {\n        errPass2.textContent = "";\n      }\n    });\n\n    form?.addEventListener("submit", async (e) => {\n      e.preventDefault();\n      statusEl.textContent = "";\n\n      if (!validate()) {\n        const firstErr = document.querySelector(".text-red-600:not(:empty)");\n        firstErr?.scrollIntoView({ behavior: "smooth", block: "center" });\n        return;\n      }\n\n      btn.disabled = true;\n      spinner.classList.remove("hidden");\n\n      const fd = new FormData(form);\n      const payload = {\n        name: (fd.get("name") || "").toString(),\n        email: (fd.get("email") || "").toString(),\n        password: (fd.get("password") || "").toString(),\n        passwordConfirm: (fd.get("passwordConfirm") || "").toString(),\n      };\n\n      try {\n        const res = await fetch("/api/signup", {\n          method: "POST",\n          headers: { "Content-Type": "application/json" },\n          credentials: "include",\n          body: JSON.stringify(payload),\n        });\n\n        if (res.ok) {\n          const redirectTo = (fd.get("redirectTo") || "/galerie").toString();\n          window.location.href = redirectTo;\n        } else {\n          const r = await res.json().catch(() => ({}));\n          statusEl.textContent = r?.error || "Erreur d\u2019inscription.";\n        }\n      } catch {\n        statusEl.textContent = "Impossible de contacter le serveur.";\n      } finally {\n        btn.disabled = false;\n        spinner.classList.add("hidden");\n      }\n    });\n  <\/script> '])), maybeRenderHead(), addAttribute(redirectTo, "value"), addAttribute(`/login?redirectTo=${encodeURIComponent(redirectTo)}`, "href")) })}`;
}, "C:/Users/ghuyt/OneDrive/Documents/GitHub/sae301-2025-Noahbrrt/src/pages/signup.astro", void 0);

const $$file = "C:/Users/ghuyt/OneDrive/Documents/GitHub/sae301-2025-Noahbrrt/src/pages/signup.astro";
const $$url = "/signup";

const _page = /*#__PURE__*/Object.freeze(/*#__PURE__*/Object.defineProperty({
  __proto__: null,
  default: $$Signup,
  file: $$file,
  prerender,
  url: $$url
}, Symbol.toStringTag, { value: 'Module' }));

const page = () => _page;

export { page };
